# (grep ^# a.lgo; pclgo --tol 0.001 a.lgo a2.legofit a2boot*.legofit; grep -v ^# a.lgo | egrep -v "\<free\>")
# Gene flow: N->Y
# XY = early modern; Y = Quechua; N=Neanderthal; D=Denisovan
# Altai and Vindija on same branch
# TmN < Tv < Ta
# Neanderthal population size allowed to change
# PCA calculated with gsl_linalg_SV_decomp
# Fraction of variance:
#      pc1      pc2      pc3      pc4      pc5      pc6      pc7      pc8
#  0.34262  0.17519  0.14201  0.08940  0.06676  0.06234  0.04828  0.02554
#      pc9     pc10     pc11     pc12     pc13     pc14     pc15
#  0.02309  0.01506  0.00503  0.00321  0.00136  0.00009  0.00001
param free [    -4,      4] pc1 = 0
param free [    -2,      2] pc2 = 0
param free [    -4,      4] pc3 = 0
param free [    -2,      2] pc4 = 0
param free [    -2,      2] pc5 = 0
param free [    -2,      2] pc6 = 0
param free [    -2,      2] pc7 = 0
param free [    -2,      2] pc8 = 0
param free [    -2,      2] pc9 = 0
param free [    -2,      2] pc10 = 0
param free [    -1,      1] pc11 = 0
param free [    -1,      1] pc12 = 0
param free [    -1,      1] pc13 = 0
time constrained Tnd = 19947.57450980393 - 81.78289069776415*pc1 -
    7.382081307817852*pc2 + 31.7844371574495*pc3 -
    57.21771290287533*pc4 + 2.098500394019853*pc5 +
    8.9076723734299*pc6 - 19.19235339218035*pc7 +
    38.73985500118157*pc8 - 17.60466706911434*pc9 +
    70.8388402418107*pc10 + 61.70872397636999*pc11 -
    148.1787681597476*pc12 - 22.25831858693393*pc13
time constrained Tav = 6016.474509803922 - 24.38482631595429*pc1 -
    33.44083161074705*pc2 - 8.372907295715498*pc3 +
    16.72501730468309*pc4 + 5.133687683619322*pc5 +
    2.996296819419644*pc6 + 11.33200948886122*pc7 +
    6.036763877795445*pc8 + 10.26559239567569*pc9 +
    10.27041538031296*pc10 - 30.13951790169513*pc11 -
    2.599517429646848*pc12 + 0.5891302427590601*pc13
time constrained Txy = 5557.493529411763 - 138.4613395525988*pc1 +
    101.1186550496263*pc2 + 13.02099154314997*pc3 +
    114.3800889497303*pc4 - 39.99679465238976*pc5 -
    17.95447638953816*pc6 + 7.569925699860836*pc7 -
    125.997598315956*pc8 - 123.3065861370278*pc9 +
    9.721361664150638*pc10 - 1.132364982682825*pc11 -
    29.69974550921494*pc12 + 284.8680967074767*pc13
time constrained Td = 2692.514901960784 - 4.279038138983061*pc1 -
    24.19796882314558*pc2 - 19.02730066571441*pc3 -
    17.20252805535901*pc4 - 18.60117914064081*pc5 +
    11.36834420804478*pc6 - 59.24849105090463*pc7 -
    27.75138238947622*pc8 + 0.7428498622118243*pc9 -
    7.736029799832489*pc10 - 6.225582534889437*pc11 +
    0.2484044426201967*pc12 + 2.229139064821448*pc13
time constrained Ta = 6014.643137254903 - 24.49259955319242*pc1 -
    33.38486216692516*pc2 - 8.413514910346672*pc3 +
    17.26341636353906*pc4 + 5.360982532481845*pc5 +
    2.87951182036447*pc6 + 11.16258740996288*pc7 +
    6.023191126455141*pc8 + 10.66990991927717*pc9 +
    10.2845388061106*pc10 - 30.36798379854478*pc11 -
    1.149410939138891*pc12 + 0.8798602496650649*pc13
time constrained Tv = 3442.587647058823 - 27.41312776066344*pc1 -
    31.19940427167992*pc2 - 12.43086471348571*pc3 +
    7.682475661619753*pc4 + 3.465699852357917*pc5 +
    6.622586935251373*pc6 + 15.03383621934465*pc7 +
    5.588475030362877*pc8 - 0.4587883333258447*pc9 -
    50.60875344806738*pc10 + 54.35661457402352*pc11 +
    9.378943259871058*pc12 + 0.7338583204786668*pc13
twoN constrained twoNav = 7708.043725490197 - 21.57988004308904*pc1 +
    17.61532080390548*pc2 + 19.24040242617643*pc3 -
    31.74771608349409*pc4 + 2.843886352484233*pc5 +
    10.16131356335562*pc6 + 3.991244784814028*pc7 +
    9.476758154083939*pc8 - 5.948555977053227*pc9 -
    47.10485237190969*pc10 - 37.97632627205733*pc11 -
    7.350715047638457*pc12 - 1.594517810183756*pc13
twoN constrained twoNn = 45388.87999999999 + 2069.319168482261*pc1 -
    3251.447394376748*pc2 + 2844.318660741675*pc3 -
    4291.804971673007*pc4 - 24173.83843239901*pc5 +
    5855.184439240134*pc6 + 11533.82720168729*pc7 -
    3255.61567024118*pc8 + 2196.049873825564*pc9 +
    1728.094800705048*pc10 + 99.33809468218413*pc11 -
    413.9721854586546*pc12 - 184.1985037788702*pc13
twoN constrained twoNd = 1326374.666666667 - 37385.11735516002*pc1 -
    45220.33387664917*pc2 - 97023.73823177777*pc3 -
    106125.3351039188*pc4 - 113861.3451505512*pc5 -
    540509.4444792239*pc6 + 23274.89219171658*pc7 +
    5043.89557035386*pc8 - 924.2714022220522*pc9 -
    56571.29949063219*pc10 - 32759.30539863648*pc11 -
    32496.71233759196*pc12 - 5369.672766109551*pc13
twoN constrained twoNv = 3744.431568627451 - 0.1868838937586038*pc1 -
    25.84334573375197*pc2 - 204.4300909095489*pc3 -
    288.8127239712507*pc4 + 196.7161375958202*pc5 +
    51.48040902022265*pc6 + 234.9526417307504*pc7 -
    295.9084747387222*pc8 - 46.80524033502534*pc9 +
    86.0205319481688*pc10 + 2.993987470904475*pc11 +
    14.12876747680576*pc12 + 6.518929675001425*pc13
twoN constrained twoNnd = 17147.39019607844 + 234.4899528596353*pc1 +
    28.68758707127845*pc2 - 138.4685289183702*pc3 +
    228.6793463564553*pc4 + 19.92169384019853*pc5 +
    12.95817920158305*pc6 + 62.759338490964*pc7 -
    175.3614210664911*pc8 + 136.0202462311896*pc9 -
    227.3201414896549*pc10 - 64.65057987874141*pc11 -
    447.768502403476*pc12 - 38.41386168948531*pc13
twoN constrained twoNxy = 40380.85686274509 + 361.4460540089219*pc1 -
    258.403351325453*pc2 + 26.77895498844315*pc3 -
    338.5362432546871*pc4 + 115.1718849399234*pc5 +
    34.8552757260137*pc6 - 1.483756411406053*pc7 +
    366.5579343137393*pc8 + 354.5050649842241*pc9 -
    15.41638610428932*pc10 + 31.58760153118427*pc11 -
    95.65950584124391*pc12 + 722.0908347229447*pc13
twoN constrained twoNxynd = 41196 - 79.26970159043236*pc1 +
    56.83069861095903*pc2 + 82.89092581573519*pc3 -
    1.590490188271439*pc4 + 17.13136820806378*pc5 -
    23.91239535307782*pc6 - 11.92582680439193*pc7 -
    93.23294079567765*pc8 + 220.3489358135751*pc9 +
    10.06814274251623*pc10 + 32.75835181783014*pc11 +
    28.13154978407563*pc12 - 4.110964086847201*pc13
param constrained msum = 0.02397690196078431 - 0.0001821817321575577*pc1 +
    0.0003960980444099267*pc2 - 0.0006089438926443301*pc3 -
    2.083709463905046e-05*pc4 - 0.0001327346315496574*pc5 +
    0.0001135527931437329*pc6 - 2.09975800027263e-05*pc7 +
    0.0003044357130663357*pc8 + 0.0001900002127597655*pc9 +
    5.547047945032136e-05*pc10 - 2.504747528153934e-05*pc11 +
    4.009196254305788e-05*pc12 - 5.043066061620931e-05*pc13
param constrained mdif = 0.0238804 - 0.0001844467682062693*pc1 +
    0.0003912300647404896*pc2 - 0.0006176717968778883*pc3 -
    1.096059288078262e-05*pc4 - 0.0001441492928097948*pc5 +
    0.0001221863973700686*pc6 - 1.981760673133263e-05*pc7 +
    0.0002903631046919693*pc8 + 0.000223102917105646*pc9 +
    2.02927717053439e-05*pc10 + 1.801797533561016e-05*pc11 +
    2.229983788803956e-05*pc12 + 8.462547371393094e-05*pc13
time fixed  zero = 0
time fixed  Txynd = 25920  # \citet[table~S12.2, p.~90]{Li:N-505-43-S88}
time constrained  Tmd = 0.5*(Txy+Td)
time constrained  Tmv = 0.5*(Tmd+Tv)
twoN fixed  one = 1
mixFrac constrained mV = 0.5*(msum + mdif)
mixFrac constrained mD = 0.5*(msum - mdif)
segment x    t=zero   twoN=one     samples=1
segment y    t=zero   twoN=one     samples=1
segment v    t=Tv     twoN=twoNv   samples=1
segment v2   t=Tmv    twoN=twoNv
segment a    t=Ta     twoN=one     samples=1
segment d    t=Td     twoN=twoNd   samples=1
segment d2   t=Tmd    twoN=twoNd
segment y2   t=Tmv    twoN=one
segment y3   t=Tmd    twoN=one
segment av   t=Tav    twoN=twoNav
segment nd   t=Tnd    twoN=twoNnd
segment xy   t=Txy    twoN=twoNxy
segment xynd t=Txynd  twoN=twoNxynd
mix    y2 from y3 + mD * d2
mix    y from y2 + mV * v2
derive v from v2
derive v2 from av
derive a from av
derive av from nd
derive d from d2
derive d2 from nd
derive x from xy
derive y3 from xy
derive xy from xynd
derive nd from xynd
